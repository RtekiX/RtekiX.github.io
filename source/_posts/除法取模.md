---
title: 除法取模
header_image: /intro/post-bg.jpg
abstract: 快速幂，扩展欧几里得(gcd)
abbrlink: 87d1f055
date: 2024-04-14 16:47:06
categories: 学习
tags:
---

### 前要
加减乘的取模运算满足分配律，但是除法不满足

#### 方法1：费马小定理
```c++
// a/b % p == a*(b^(p-2))%p
// p为素数
using LL = long long int;

LL pow(LL a, LL b, LL p) {
    // (a^b)%p
    if(a == 0) {
        return 0; 
    }
    if(b == 0) {
        return a % p;
    }
    LL res = 1;
    while(b != 0) {
        if(b & 1) {
            res = res*a % p;
        }
        a = a*a % p;
        b >>= 1;
    }
    return a;
}

LL a_div_b_mod_p(LL a, LL b, LL p) {
    return (a%p)*(pow(b, p-2, p)%p) % p;
}
```

#### 扩展欧几里得算法
计算a，b最大公约数的同时算出逆元
```c++
using LL = long long int;

void ex_gcd(LL a, LL b, LL &x, LL &y) {
    // x即为逆元
    // ax + by == gcd(a, b)
    // ax === 1(mod m)
    if(a < b) {
        swap(a, b);
    }
    if(b == 0) {
        x = 1;
        y = 0;
        return;
    }
    ex_gcd(b, a%b, x, y);
    int temp = x;
    x = y;
    y = temp - a/b * y;
}
```
