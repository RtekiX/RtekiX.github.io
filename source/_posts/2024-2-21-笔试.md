---
title: 2024/2/21-笔试
header_image: /intro/post-bg.jpg
abstract: 简单记录一下
categories: 学习
tags:
  - 笔试
abbrlink: 4a67726
date: 2024-02-21 14:15:31
---

### 选择题
MySQL分布式事务：XA事务，2pc。将分布式事务执行的过程分为两阶段，第一阶段所有需要执行操作的节点准备自身资源数据，检查是否可以提交，向事务管理节点发送precommit的消息。所有节点都准备就绪precommit后，才能开始实际执行事务，期间等待是阻塞的。

Java垃圾回收：强引用，任何时候都不回收；软引用，空间不足时回收；弱引用和虚引用，任何时候都回收。

### 编程题
#### 第一题忘了，比较简单
#### 第二题
第二题题意是，一个数组中，任选两个元素删除，并将它们的和再加入数组，使数组的极差最小。

##### 思路
用优先队列读入元素，删除最小的两个元素，再加入数组。过了90%。

忘记考虑的点：最小的两个元素相加后，可能大于原数组最大的元素，而我直接默认优先队列头的元素最大了，测试数据中可能出现了负数。

#### 第三题
n个杯子中有k杯水，每个回合可能的行为：
- 随机选择一个杯子
- 如果杯子空：则回合结束
- 如果杯子不空：上回合喝过水了，则放下杯子回合结束；上回合没喝水，则喝掉杯子里的水

最终求所有水被喝完时的回合数的期望值。

##### 思路
很明显是一个数学题。假如不考虑两次喝水之间的间隙，还剩i杯水的时候，喝到水的概率p=i/n。此时，喝一杯水的期望回合是：
```
T = p*1 + p(1-p)*2 + p(1-p)^2*3 + ... + p(1-p)^n*(n+1)
  = i/n(1-p)^2
```
然后令i=k，i=k-1, ... i=1，累加即可

没想出来的地方：两次喝水有间隙——卡在这里很久，实际上只需要在最后的结果加上k-1个回合就可以了。

